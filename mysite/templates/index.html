<!DOCTYPE HTML>
<!--
	Hyperspace by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
<head>
    {% load static %}
    <title>TRANSPORTATION</title>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"/>
    <link rel="stylesheet" href="{% static 'assets/css/main.css' %}"/>
    <noscript>
        <link rel="stylesheet" href="{% static 'assets/css/noscript.css' %}"/>
    </noscript>
    <script src="https://fastly.jsdelivr.net/npm/sweetalert2@11.7.11/dist/sweetalert2.all.min.js"></script>
    <link href="https://fastly.jsdelivr.net/npm/sweetalert2@11.7.11/dist/sweetalert2.min.css" rel="stylesheet">
</head>
<body class="is-preload">

<!-- Sidebar -->
<section id="sidebar">
    <div class="inner">
        <nav>
            <ul>
                <li><a href="#intro">Welcome</a></li>
                <li><a href="#one">Find the Best Route</a></li>
                <li><a href="#two">Route List</a></li>
<!--                <li><a href="#three">[Subpage 3]</a></li>-->
            </ul>
        </nav>
    </div>
</section>

<!-- Wrapper -->
<div id="wrapper">

    <!-- Intro -->
    <section id="intro" class="wrapper style1 fullscreen fade-up">
        <div class="inner">
            <h1>Find Best Bus Route in Manchester</h1>
            <p> </p>
            <ul class="actions">
                <li><a href="#one" class="button scrolly">Learn more</a></li>
            </ul>
        </div>
    </section>

    <!-- One -->
    <section id="one" class="wrapper style1 fade-up">
        <div class="inner">
            <h2>Find the Best Route</h2>
            <p>Only for the main part of Manchester.</p>
            <div class="segmented-control" style="margin-top: -20px">
                <input type="radio" name="option" id="option1" value="cheapest" checked>
                <label for="option1">Cheapest</label>
                <input type="radio" name="option" id="option2" value="quickest">
                <label for="option2">Quickest</label>
            </div>
            <div class="split style2">
                <section>
                    <br>
                    <h3>Choose the station</h3>
                    <p> </p>
                        {% csrf_token %}
                        <div class="fields">
                            <div class="field">
                                <p>Start Station: </p>
                                <input type="text" name="start" id="start" placeholder="Please enter the station name" style="height: 100px; margin-top: -40px;"/>
                            </div>
                            <br>
                            <div class="field">
                                <p>End Station: </p>
                                <input type="text" name="end" id="end" placeholder="Please enter the station name" style="height: 100px; margin-top: -40px;"/>
                            </div>
                            <br>
                            <button type="submit" class="submit-button">Search</button>
                        </div>

<!--                    </form>-->
                </section>
                <section>
                    <div class="inner">
                        <br>
                        <h3>Result</h3>
                        <p> </p>
                        <div class="table-wrapper">
                            <table>
                                <tbody>
                                    <tr>
                                        <td>Route</td>
                                        <td id="route">[Cheapest Route]</td>
                                    </tr>
                                    <tr>
                                        <td>Stations</td>
                                        <td>
                                            <table>
                                                <tr>
                                                    <td>Start: <span id="start-station">[Start Station]</span></td>
                                                </tr>
                                                <tr>
                                                    <td>Transfer: <span id="transfer-station">[Transfer Stations]</span></td>
                                                </tr>
                                                <tr>
                                                    <td>End: <span id="end-station">[End Station]</span></td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Line Used</td>
                                        <td id="line-used">[Line Used]</td>
                                    </tr>
                                    <tr id="cost-row">
                                        <td>Cost</td>
                                        <td id="cost">[Cost]</td>
                                    </tr>
                                    <tr id="blank-row">
                                        <td>Blank</td>
                                        <td id="blank">[Blank]</td>
                                    <tr id="time-row">
                                        <td>Time</td>
                                        <td id="time">[Time]</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                    </div>
                </section>
            </div>
        </div>
    </section>

    <!-- Two -->
    <section id="two" class="wrapper style3 fade-up">
        <div class="inner">
            <h2>Bus Route List</h2>
            <p>Explore available bus routes in Manchester.</p>

            <!-- 动态生成路线列表 -->
            <div id="bus-route-list">
                {% for route, stops in routes_with_stops.items %}
                <div class="collapsible">
                    <div class="route">
                        <h3>{{ route }}</h3>
                        <ul class="stops-list" style="display:none;">
                            {% for stop in stops %}
                            <li>{{ stop }}</li>
                            {% endfor %}
                        </ul>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </section>

<!--    &lt;!&ndash; Two &ndash;&gt;-->
<!--    <section id="two" class="wrapper style3 fade-up">-->
<!--        <div class="inner">-->
<!--            <h2>Bus Route List</h2>-->
<!--            <p>Explore available bus routes in Manchester.</p>-->

<!--            &lt;!&ndash; Placeholder for the list of bus routes &ndash;&gt;-->
<!--            <div id="bus-route-list">-->
<!--                &lt;!&ndash; Each route is a collapsible section &ndash;&gt;-->
<!--                <div class="collapsible">-->
<!--                    <div class="route">-->
<!--                        <h3>Route 1</h3>-->
<!--                        <ul class="stops-list">-->
<!--                            &lt;!&ndash; Placeholder for route 1 stops &ndash;&gt;-->
<!--                            <li>Stop 1</li>-->
<!--                            <li>Stop 2</li>-->
<!--                            &lt;!&ndash; Add more stops as needed &ndash;&gt;-->
<!--                        </ul>-->
<!--                    </div>-->
<!--                </div>-->

<!--                <div class="collapsible">-->
<!--                    <div class="route">-->
<!--                        <h3>Route 2</h3>-->
<!--                        <ul class="stops-list">-->
<!--                            &lt;!&ndash; Placeholder for route 2 stops &ndash;&gt;-->
<!--                            <li>Stop A</li>-->
<!--                            <li>Stop B</li>-->
<!--                            &lt;!&ndash; Add more stops as needed &ndash;&gt;-->
<!--                        </ul>-->
<!--                    </div>-->
<!--                </div>-->

<!--                &lt;!&ndash; Add more collapsible sections for additional routes &ndash;&gt;-->
<!--            </div>-->
<!--        </div>-->
<!--    </section>-->

<!--    &lt;!&ndash; Three &ndash;&gt;-->
<!--    <section id="three" class="wrapper style2 spotlights">-->
<!--        <section>-->
<!--            <a href="#" class="image"><img src="{% static 'images/pic01.jpg' %}" alt="" data-position="center center"/></a>-->
<!--            <div class="content">-->
<!--                <div class="inner">-->
<!--                    <h2>[Function 1]</h2>-->
<!--                    <p>[Description 1]</p>-->
<!--                    <ul class="actions">-->
<!--                        <li><a href="generic.html" class="button">Learn more</a></li>-->
<!--                    </ul>-->
<!--                </div>-->
<!--            </div>-->
<!--        </section>-->
<!--        <section>-->
<!--            <a href="#" class="image"><img src="{% static 'images/pic02.jpg' %}" alt="" data-position="top center"/></a>-->
<!--            <div class="content">-->
<!--                <div class="inner">-->
<!--                    <h2>[Function 2]</h2>-->
<!--                    <p>[Description 2]</p>-->
<!--                    <ul class="actions">-->
<!--                        <li><a href="generic.html" class="button">Learn more</a></li>-->
<!--                    </ul>-->
<!--                </div>-->
<!--            </div>-->
<!--        </section>-->
<!--        <section>-->
<!--            <a href="#" class="image"><img src="{% static 'images/pic03.jpg' %}" alt="" data-position="25% 25%"/></a>-->
<!--            <div class="content">-->
<!--                <div class="inner">-->
<!--                    <h2>[Function 3]</h2>-->
<!--                    <p>[Description 3]</p>-->
<!--                    <ul class="actions">-->
<!--                        <li><a href="generic.html" class="button">Learn more</a></li>-->
<!--                    </ul>-->
<!--                </div>-->
<!--            </div>-->
<!--        </section>-->
<!--    </section>-->

</div>

<!-- Footer -->
<footer id="footer" class="wrapper style1-alt">
    <div class="inner">
        <ul class="menu">
            <li>&copy; Untitled. All rights reserved.</li>
            <li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
        </ul>
    </div>
</footer>

<!-- Scripts -->
<script src="{% static 'assets/js/jquery.min.js' %}"></script>
<script src="{% static 'assets/js/jquery.scrollex.min.js' %}"></script>
<script src="{% static 'assets/js/jquery.scrolly.min.js' %}"></script>
<script src="{% static 'assets/js/browser.min.js' %}"></script>
<script src="{% static 'assets/js/breakpoints.min.js' %}"></script>
<script src="{% static 'assets/js/util.js' %}"></script>
<script src="{% static 'assets/js/main.js' %}"></script>
<script>
    $('.submit-button').on('click', function (event) {
        var csrftoken = jQuery("[name=csrfmiddlewaretoken]").val();
        var selectedOption = $('input[name="option"]:checked').val();
        var data = {
            start: $('input[name="start"]').val(),
            end: $('input[name="end"]').val(),
            option: selectedOption,
        };
        $.ajax({
            url: '/transportation/process_route/',
            method: 'POST',
            headers: {"X-CSRFToken": csrftoken},
            data: JSON.stringify(data),
            contentType: 'application/json',
            success: function (result) {
                if (result.ret === 1) {
                    $("#start-station").text(result.start);
                    var transferPointsText = result.transfer_points.length > 0 ? result.transfer_points : "N/A";
                    $("#transfer-station").text(transferPointsText);
                    $("#end-station").text(result.end);
                    $("#cost").text(result.total_cost);
                    $("#time").text(result.total_time);
                    $("#route").text(result.route);
                    $("#line-used").text(result.line_used);
                } else {
                    Swal.fire({
                        icon: 'error',
                        title: 'Error',
                        text: result.msg
                    });
                }
            },
            error: function () {
                Swal.fire({
                    icon: 'error',
                    title: '{$Think.lang.status.error}',
                    text: '{$Think.lang.systemError}'
                });
            }
        });
    });
    $('input[type=radio][name=option]').change(function() {
        if (this.value === 'cheapest') {
            $("#cost-row").show();
            $("#time-row").hide();
            $("#blank-row").hide();
        }
        else if (this.value === 'quickest') {
            $("#time-row").show();
            $("#cost-row").hide();
            $("#blank-row").hide();
        }
    });
    $(document).ready(function() {
        $("#time-row").hide();
        $("#blank-row").hide();
    });
</script>
<script>
    // Toggle the visibility of stops for each route
    $('.collapsible').on('click', '.route h3', function () {
        $(this).siblings('.stops-list').toggle();
    });
</script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    var toggle = false; // 标记状态：false表示收起，true表示展开
    document.getElementById('toggle-routes').addEventListener('click', function() {
        toggle = !toggle; // 切换状态
        var stopsLists = document.querySelectorAll('.stops-list'); // 选择所有路线的列表
        stopsLists.forEach(function(list) {
            if (toggle) {
                list.style.display = 'block'; // 展开
            } else {
                list.style.display = 'none'; // 收起
            }
        });
    });
});
</script>

</body>
</html>